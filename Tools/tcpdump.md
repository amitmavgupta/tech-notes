# tcpdump notes

```
#tcpdump -p -ni -eth0 -d “ip and tcp and port 80”
```

- To trace tcp to 1.2.3.4:443, do this
```
#iptables -t raw -A PREROUTING -p tcp --destination 1.2.3.4 --dport 443 -j TRACE
```
The output will be in dmesg
```
#dmesg
[  440.551175] TRACE: raw:PREROUTING:policy:2 IN=pconn1 OUT= MAC= SRC=100.64.1.1 DST=100.160.0.23 LEN=84 TOS=0x00 PREC=0x00 TTL=255 ID=38856 DF PROTO=ICMP TYPE=8 CODE=0 ID=9464 SEQ=87
[  440.565646] TRACE: mangle:PREROUTING:rule:2 IN=pconn1 OUT= MAC= SRC=100.64.1.1 DST=100.160.0.23 LEN=84 TOS=0x00 PREC=0x00 TTL=255 ID=38856 DF PROTO=ICMP TYPE=8 CODE=0 ID=9464 SEQ=87
[  440.579888] TRACE: mangle:PREROUTING:rule:9 IN=pconn1 OUT= MAC= SRC=100.64.1.1 DST=100.160.0.23 LEN=84 TOS=0x00 PREC=0x00 TTL=255 ID=38856 DF PROTO=ICMP TYPE=8 CODE=0 ID=9464 SEQ=87 MARK=0x200
[  440.595050] TRACE: mangle:PREROUTING:policy:15 IN=pconn1 OUT= MAC= SRC=100.64.1.1 DST=100.160.0.23 LEN=84 TOS=0x00 PREC=0x00 TTL=255 ID=38856 DF PROTO=ICMP TYPE=8 CODE=0 ID=9464 SEQ=87 MARK=0x200
```